"use strict";(self["webpackChunkjili"]=self["webpackChunkjili"]||[]).push([[882],{4882:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"body"},[t("div",{staticClass:"header"},[t("van-nav-bar",{attrs:{fixed:"",placeholder:"",title:"后台管理页面","left-text":"","left-arrow":""},on:{"click-left":e.goBack},scopedSlots:e._u([{key:"right",fn:function(){return[t("van-popover",{attrs:{trigger:"click",actions:e.actions},on:{select:e.onSelect},scopedSlots:e._u([{key:"reference",fn:function(){return[t("van-button",{attrs:{icon:"setting-o",type:"primary",text:"功能选择"}})]},proxy:!0}]),model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}})]},proxy:!0}])}),t("van-search",{attrs:{shape:"round",background:"#4fc08d",placeholder:"请输入搜索关键词"},on:{search:e.searchItem},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),t("van-divider",[e._v("商品列表")]),t("div",{staticClass:"main"},[t("div",e._l(e.items,(function(a){return t("div",{key:a.iid},[t("van-swipe-cell",{scopedSlots:e._u([{key:"right",fn:function(){return[t("van-button",{staticClass:"delete-button",attrs:{square:"",text:"删除",type:"danger"},on:{click:function(t){return e.delItem(a)}}}),t("van-button",{attrs:{text:"分类",type:"primary"},on:{click:function(t){return e.PreClassify(a.iid)}}})]},proxy:!0}],null,!0)},[t("van-card",{staticClass:"goods-card",attrs:{num:a.quantity,price:a.price,desc:a.comment,title:a.name,thumb:e.base+a.img}})],1),t("br")],1)})),0)]),t("van-divider",[e._v("到底啦")]),t("div",{staticClass:"footer"},[t("van-pagination",{attrs:{"total-items":e.count,"items-per-page":5,"show-page-size":4,"force-ellipses":""},on:{change:e.pageChange},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),t("van-popup",{model:{value:e.flag.classify,callback:function(t){e.$set(e.flag,"classify",t)},expression:"flag.classify"}},[t("div",{staticStyle:{width:"15rem",margin:"1rem"}},[t("van-radio-group",{model:{value:e.cid,callback:function(t){e.cid=t},expression:"cid"}},[t("van-cell-group",e._l(e.classes,(function(e){return t("van-cell",{key:e.cid,attrs:{clickable:"",title:e.classname}},[t("van-radio",{attrs:{name:e.cid}})],1)})),1)],1),t("van-button",{staticStyle:{width:"100%"},attrs:{type:"info",round:""},on:{click:e.submitClassify}},[e._v("确定")])],1)]),t("van-popup",{model:{value:e.flag.showAdd,callback:function(t){e.$set(e.flag,"showAdd",t)},expression:"flag.showAdd"}},[t("div",{staticStyle:{width:"20rem"}},[t("van-row",[t("van-col",{attrs:{span:24}},[t("br"),t("van-uploader",{attrs:{name:"uploader","after-read":e.onRead}},[t("van-icon",{attrs:{name:"photograph"}})],1),t("br"),t("van-form",{on:{submit:e.onSubmit}},[t("van-field",{attrs:{name:"商品名称",label:"商品名称",placeholder:"商品名称",rules:[{required:!0,message:"请填写商品名称"}]},model:{value:e.add.name,callback:function(t){e.$set(e.add,"name",t)},expression:"add.name"}}),t("van-field",{attrs:{label:"商品材质",rules:[{required:!0,message:"请填写商品材质"}]},model:{value:e.add.material,callback:function(t){e.$set(e.add,"material",t)},expression:"add.material"}}),t("van-field",{attrs:{type:"number",label:"商品价格",rules:[{required:!0,message:"请填写商品价格"}]},model:{value:e.add.price,callback:function(t){e.$set(e.add,"price",t)},expression:"add.price"}}),t("van-field",{attrs:{type:"digit",label:"库存数量",rules:[{required:!0,message:"请填写库存数量"}]},model:{value:e.add.quantity,callback:function(t){e.$set(e.add,"quantity",t)},expression:"add.quantity"}}),t("van-field",{attrs:{type:"text",name:"备注",label:"备注",placeholder:"备注",rules:[{required:!0,message:"请填写商品备注"}]},model:{value:e.add.comment,callback:function(t){e.$set(e.add,"comment",t)},expression:"add.comment"}}),t("div",{staticStyle:{margin:"16px"}},[t("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[e._v("提交")])],1)],1)],1)],1)],1)])],1)},i=[],n=(a(7658),a(306)),l=a(521);console.log(l.Z);const d={data(){return{flag:{showAdd:!1,classify:!1},value:"",currentPage:1,showPopover:!1,actions:[{text:"新增",icon:"add-o"},{text:"类别",icon:"label-o"},{text:"活动",icon:"gem-o"}],add:{name:"",price:0,comment:"",quantity:0,material:""},iid:"",cid:"",items:[],count:100,file:"",classes:[]}},computed:{base(){return n.Z.defaults.baseURL}},methods:{goBack(){this.$router.push("/index")},onSelect(e,t){switch(t){case 0:this.flag.showAdd=!0,console.log("新增物品");break;case 1:this.$router.push("/admin/itemclass");break;case 2:this.$router.push("/admin/activity");break;default:console.log("非法操作!");break}},onSubmit(){console.log(this.file);let e=new FormData;e.set("image",this.file.file),e.set("name",this.add.name),e.set("price",this.add.price),e.set("material",this.add.material),e.set("quantity",this.add.quantity),e.set("comment",this.add.comment),n.Z.post("/admin/add",e).then((e=>{(0,l.Z)(e.data.msg),e.data.data&&(this.pageChange(),this.itemsCount())})),this.flag.showAdd=!1,this.add.name="",this.add.price=0,this.add.comment="",this.add.quantity=0,this.add.material=""},getItemClasses(){n.Z.get("/admin/itemclasses").then((e=>{this.classes=e.data.data}))},PreClassify(e){this.getItemClasses(),this.flag.classify=!0,this.iid=e},submitClassify(){console.log(this.iid,this.cid),n.Z.post("/admin/addic",{iid:this.iid,cid:this.cid}).then((e=>{(0,l.Z)(e.data.msg)})),this.cid=""},pageChange(){console.log(this.currentPage),n.Z.get(`/items/${this.currentPage}/5`).then((e=>{this.items=e.data.data}))},itemsCount(){n.Z.get("/items/count").then((e=>{this.count=parseInt(e.data.data)}))},delItem(e){n.Z.delete(`/admin/${e.iid}`).then((e=>{(0,l.Z)(e.data.msg),e.data.data&&(this.pageChange(),this.itemsCount())}))},onRead(e){this.file=e},searchItem(){let e=new FormData;e.set("key",this.value),n.Z.post("/admin/search",e).then((e=>{this.items=e.data.data}))}},mounted(){this.itemsCount(),this.pageChange()}};var o=d,r=o,c=a(1001),u=(0,c.Z)(r,s,i,!1,null,null,null),m=u.exports}}]);
//# sourceMappingURL=882.18c5c4de.js.map